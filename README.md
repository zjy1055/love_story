# 恋爱故事记录应用

一个纯Python开发的单机恋爱故事记录应用程序，用于记录与伴侣的珍贵回忆和重要时刻。该应用提供了直观的界面和丰富的功能，帮助用户永久保存和随时回顾恋爱中的美好时光。

## 功能特点

- **首页展示**：精选照片轮播、重要纪念日倒计时、个人格言和相处守则
- **事件记录**：记录恋爱中的重要事件，包含标题、日期和详细描述
- **高级照片管理**：
  - 照片上传（支持批量上传）
  - 缩略图预览和大图查看
  - 照片分类管理（相册和事件关联）
  - 照片标签功能
  - 照片搜索（按描述和标签搜索）
  - 高级搜索（按关键词、日期范围、相册、事件和标签筛选）
- **数据持久化**：使用轻量级SQLite数据库保存所有信息
- **完整的数据备份与恢复系统**：
  - 一键备份所有数据
  - 从备份文件恢复数据
  - 备份列表管理
  - 清理旧备份功能
- **响应式设计**：适配不同屏幕尺寸的设备

## 技术架构

- **后端**：Python Flask框架
- **前端**：HTML5, CSS3, JavaScript (响应式设计)
- **数据库**：SQLite
- **照片处理**：Pillow (Python图像处理库)
- **打包工具**：PyInstaller

## 安装与运行

### 开发环境

1. 确保已安装Python 3.6或更高版本

2. 安装依赖：
```
pip install -r requirements.txt
```

3. 运行应用：
```
python main.py
```
或者使用原始的运行脚本：
```
python run_app.py
```

### 打包应用

应用已配置好打包脚本，只需运行：
```
./build.bat  # Windows系统
```

打包完成后，可执行文件将位于 `dist/` 目录下。

## 数据存储位置

为了确保数据持久性和跨平台兼容性，应用程序将数据存储在用户目录下：
- Windows: `C:\Users\用户名\.love_story_app\`
- macOS: `/Users/用户名/.love_story_app/`
- Linux: `/home/用户名/.love_story_app/`

数据目录包含：
- `love_story.db` - 数据库文件
- `uploads/` - 照片文件
- `backups/` - 备份文件

## 文件结构

```
love_story_app/
├── backend/         # 后端API代码
│   ├── app.py       # Flask应用主入口
│   ├── routes.py    # API路由定义
│   ├── models.py    # 数据库模型
│   └── utils.py     # 工具函数
├── frontend/        # 前端页面
│   ├── index.html   # 主页面
│   ├── scripts.js   # JavaScript代码
│   └── styles.css   # CSS样式
├── main.py          # 应用程序主入口（支持打包）
├── run_app.py       # 开发用运行脚本
├── build.bat        # Windows打包脚本
├── love_story.spec  # PyInstaller配置
├── requirements.txt # 依赖列表
└── README.md        # 项目说明文档
```

## 使用说明

### 1. 首页展示
- 查看精选照片轮播
- 浏览重要纪念日倒计时
- 阅读和修改个人格言和相处守则

### 2. 事件记录
- 点击"添加事件"创建新的重要事件
- 填写事件标题、日期和详细描述
- 查看和编辑已有的事件记录
- 删除不再需要的事件

### 3. 照片管理
- **上传照片**：
  - 单张上传：选择照片文件，填写描述，选择相册和事件
  - 批量上传：一次性上传多张照片，统一设置相册和事件
- **照片查看**：
  - 缩略图网格预览
  - 点击查看大图
  - 左右切换浏览
- **照片搜索**：
  - 快速搜索：在搜索框中输入关键词
  - 高级搜索：使用搜索条件组合筛选照片

### 4. 配置管理
- 设置重要纪念日（首页将显示倒计时）
- 更新个人格言和相处守则
- 管理相册和事件分类

### 5. 数据备份与恢复
- **创建备份**：点击"创建备份"按钮生成数据快照
- **管理备份**：
  - 查看现有的备份列表
  - 从列表中选择备份进行恢复
  - 删除不需要的备份
- **清理旧备份**：自动清理超过保留期的备份文件

## 注意事项

1. 请定期进行数据备份，防止意外情况导致数据丢失
2. 照片文件占用空间较大，请注意及时清理不需要的照片
3. 应用程序需要访问本地文件系统以存储照片和数据库
4. 打包后的应用程序在首次运行时会在用户目录下创建必要的文件夹结构

## 常见问题

**Q: 如何备份我的数据？**
A: 在配置页面点击"创建备份"按钮，数据将备份到用户目录下的`.love_story_app/backups/`文件夹中。

**Q: 照片存储在哪里？**
A: 照片存储在用户目录下的`.love_story_app/uploads/`文件夹中。

**Q: 应用程序可以在不同设备间同步数据吗？**
A: 目前不支持自动同步，但您可以通过备份和恢复功能手动在设备间迁移数据。